{"ast":null,"code":"import { shuffle } from \"../array.js\";\nimport lcg from \"../lcg.js\";\nexport default function (circles) {\n  return packEncloseRandom(circles, lcg());\n}\nexport function packEncloseRandom(circles, random) {\n  var i = 0,\n      n = (circles = shuffle(Array.from(circles), random)).length,\n      B = [],\n      p,\n      e;\n\n  while (i < n) {\n    p = circles[i];\n    if (e && enclosesWeak(e, p)) ++i;else e = encloseBasis(B = extendBasis(B, p)), i = 0;\n  }\n\n  return e;\n}\n\nfunction extendBasis(B, p) {\n  var i, j;\n  if (enclosesWeakAll(p, B)) return [p]; // If we get here then B must have at least one element.\n\n  for (i = 0; i < B.length; ++i) {\n    if (enclosesNot(p, B[i]) && enclosesWeakAll(encloseBasis2(B[i], p), B)) {\n      return [B[i], p];\n    }\n  } // If we get here then B must have at least two elements.\n\n\n  for (i = 0; i < B.length - 1; ++i) {\n    for (j = i + 1; j < B.length; ++j) {\n      if (enclosesNot(encloseBasis2(B[i], B[j]), p) && enclosesNot(encloseBasis2(B[i], p), B[j]) && enclosesNot(encloseBasis2(B[j], p), B[i]) && enclosesWeakAll(encloseBasis3(B[i], B[j], p), B)) {\n        return [B[i], B[j], p];\n      }\n    }\n  } // If we get here then something is very wrong.\n\n\n  throw new Error();\n}\n\nfunction enclosesNot(a, b) {\n  var dr = a.r - b.r,\n      dx = b.x - a.x,\n      dy = b.y - a.y;\n  return dr < 0 || dr * dr < dx * dx + dy * dy;\n}\n\nfunction enclosesWeak(a, b) {\n  var dr = a.r - b.r + Math.max(a.r, b.r, 1) * 1e-9,\n      dx = b.x - a.x,\n      dy = b.y - a.y;\n  return dr > 0 && dr * dr > dx * dx + dy * dy;\n}\n\nfunction enclosesWeakAll(a, B) {\n  for (var i = 0; i < B.length; ++i) {\n    if (!enclosesWeak(a, B[i])) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nfunction encloseBasis(B) {\n  switch (B.length) {\n    case 1:\n      return encloseBasis1(B[0]);\n\n    case 2:\n      return encloseBasis2(B[0], B[1]);\n\n    case 3:\n      return encloseBasis3(B[0], B[1], B[2]);\n  }\n}\n\nfunction encloseBasis1(a) {\n  return {\n    x: a.x,\n    y: a.y,\n    r: a.r\n  };\n}\n\nfunction encloseBasis2(a, b) {\n  var x1 = a.x,\n      y1 = a.y,\n      r1 = a.r,\n      x2 = b.x,\n      y2 = b.y,\n      r2 = b.r,\n      x21 = x2 - x1,\n      y21 = y2 - y1,\n      r21 = r2 - r1,\n      l = Math.sqrt(x21 * x21 + y21 * y21);\n  return {\n    x: (x1 + x2 + x21 / l * r21) / 2,\n    y: (y1 + y2 + y21 / l * r21) / 2,\n    r: (l + r1 + r2) / 2\n  };\n}\n\nfunction encloseBasis3(a, b, c) {\n  var x1 = a.x,\n      y1 = a.y,\n      r1 = a.r,\n      x2 = b.x,\n      y2 = b.y,\n      r2 = b.r,\n      x3 = c.x,\n      y3 = c.y,\n      r3 = c.r,\n      a2 = x1 - x2,\n      a3 = x1 - x3,\n      b2 = y1 - y2,\n      b3 = y1 - y3,\n      c2 = r2 - r1,\n      c3 = r3 - r1,\n      d1 = x1 * x1 + y1 * y1 - r1 * r1,\n      d2 = d1 - x2 * x2 - y2 * y2 + r2 * r2,\n      d3 = d1 - x3 * x3 - y3 * y3 + r3 * r3,\n      ab = a3 * b2 - a2 * b3,\n      xa = (b2 * d3 - b3 * d2) / (ab * 2) - x1,\n      xb = (b3 * c2 - b2 * c3) / ab,\n      ya = (a3 * d2 - a2 * d3) / (ab * 2) - y1,\n      yb = (a2 * c3 - a3 * c2) / ab,\n      A = xb * xb + yb * yb - 1,\n      B = 2 * (r1 + xa * xb + ya * yb),\n      C = xa * xa + ya * ya - r1 * r1,\n      r = -(Math.abs(A) > 1e-6 ? (B + Math.sqrt(B * B - 4 * A * C)) / (2 * A) : C / B);\n  return {\n    x: x1 + xa + xb * r,\n    y: y1 + ya + yb * r,\n    r: r\n  };\n}","map":{"version":3,"names":["shuffle","lcg","circles","packEncloseRandom","random","i","n","Array","from","length","B","p","e","enclosesWeak","encloseBasis","extendBasis","j","enclosesWeakAll","enclosesNot","encloseBasis2","encloseBasis3","Error","a","b","dr","r","dx","x","dy","y","Math","max","encloseBasis1","x1","y1","r1","x2","y2","r2","x21","y21","r21","l","sqrt","c","x3","y3","r3","a2","a3","b2","b3","c2","c3","d1","d2","d3","ab","xa","xb","ya","yb","A","C","abs"],"sources":["/home/aurimas/coding/idendro/frontend/node_modules/d3-hierarchy/src/pack/enclose.js"],"sourcesContent":["import {shuffle} from \"../array.js\";\nimport lcg from \"../lcg.js\";\n\nexport default function(circles) {\n  return packEncloseRandom(circles, lcg());\n}\n\nexport function packEncloseRandom(circles, random) {\n  var i = 0, n = (circles = shuffle(Array.from(circles), random)).length, B = [], p, e;\n\n  while (i < n) {\n    p = circles[i];\n    if (e && enclosesWeak(e, p)) ++i;\n    else e = encloseBasis(B = extendBasis(B, p)), i = 0;\n  }\n\n  return e;\n}\n\nfunction extendBasis(B, p) {\n  var i, j;\n\n  if (enclosesWeakAll(p, B)) return [p];\n\n  // If we get here then B must have at least one element.\n  for (i = 0; i < B.length; ++i) {\n    if (enclosesNot(p, B[i])\n        && enclosesWeakAll(encloseBasis2(B[i], p), B)) {\n      return [B[i], p];\n    }\n  }\n\n  // If we get here then B must have at least two elements.\n  for (i = 0; i < B.length - 1; ++i) {\n    for (j = i + 1; j < B.length; ++j) {\n      if (enclosesNot(encloseBasis2(B[i], B[j]), p)\n          && enclosesNot(encloseBasis2(B[i], p), B[j])\n          && enclosesNot(encloseBasis2(B[j], p), B[i])\n          && enclosesWeakAll(encloseBasis3(B[i], B[j], p), B)) {\n        return [B[i], B[j], p];\n      }\n    }\n  }\n\n  // If we get here then something is very wrong.\n  throw new Error;\n}\n\nfunction enclosesNot(a, b) {\n  var dr = a.r - b.r, dx = b.x - a.x, dy = b.y - a.y;\n  return dr < 0 || dr * dr < dx * dx + dy * dy;\n}\n\nfunction enclosesWeak(a, b) {\n  var dr = a.r - b.r + Math.max(a.r, b.r, 1) * 1e-9, dx = b.x - a.x, dy = b.y - a.y;\n  return dr > 0 && dr * dr > dx * dx + dy * dy;\n}\n\nfunction enclosesWeakAll(a, B) {\n  for (var i = 0; i < B.length; ++i) {\n    if (!enclosesWeak(a, B[i])) {\n      return false;\n    }\n  }\n  return true;\n}\n\nfunction encloseBasis(B) {\n  switch (B.length) {\n    case 1: return encloseBasis1(B[0]);\n    case 2: return encloseBasis2(B[0], B[1]);\n    case 3: return encloseBasis3(B[0], B[1], B[2]);\n  }\n}\n\nfunction encloseBasis1(a) {\n  return {\n    x: a.x,\n    y: a.y,\n    r: a.r\n  };\n}\n\nfunction encloseBasis2(a, b) {\n  var x1 = a.x, y1 = a.y, r1 = a.r,\n      x2 = b.x, y2 = b.y, r2 = b.r,\n      x21 = x2 - x1, y21 = y2 - y1, r21 = r2 - r1,\n      l = Math.sqrt(x21 * x21 + y21 * y21);\n  return {\n    x: (x1 + x2 + x21 / l * r21) / 2,\n    y: (y1 + y2 + y21 / l * r21) / 2,\n    r: (l + r1 + r2) / 2\n  };\n}\n\nfunction encloseBasis3(a, b, c) {\n  var x1 = a.x, y1 = a.y, r1 = a.r,\n      x2 = b.x, y2 = b.y, r2 = b.r,\n      x3 = c.x, y3 = c.y, r3 = c.r,\n      a2 = x1 - x2,\n      a3 = x1 - x3,\n      b2 = y1 - y2,\n      b3 = y1 - y3,\n      c2 = r2 - r1,\n      c3 = r3 - r1,\n      d1 = x1 * x1 + y1 * y1 - r1 * r1,\n      d2 = d1 - x2 * x2 - y2 * y2 + r2 * r2,\n      d3 = d1 - x3 * x3 - y3 * y3 + r3 * r3,\n      ab = a3 * b2 - a2 * b3,\n      xa = (b2 * d3 - b3 * d2) / (ab * 2) - x1,\n      xb = (b3 * c2 - b2 * c3) / ab,\n      ya = (a3 * d2 - a2 * d3) / (ab * 2) - y1,\n      yb = (a2 * c3 - a3 * c2) / ab,\n      A = xb * xb + yb * yb - 1,\n      B = 2 * (r1 + xa * xb + ya * yb),\n      C = xa * xa + ya * ya - r1 * r1,\n      r = -(Math.abs(A) > 1e-6 ? (B + Math.sqrt(B * B - 4 * A * C)) / (2 * A) : C / B);\n  return {\n    x: x1 + xa + xb * r,\n    y: y1 + ya + yb * r,\n    r: r\n  };\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}